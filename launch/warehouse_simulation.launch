<?xml version="1.0"?>
<launch>
  <!-- Warehouse PedSim + Gazebo Simulation (Pedestrians Only) -->
  <param name="use_sim_time" value="true"/>

  <!-- Arguments -->
  <arg name="scene_file" default="/maps/warehouse_pedsim.xml"/>
  <arg name="world_file" default="/maps/warehouse.world"/>
  <arg name="simulation_factor" default="1.0"/>
  <arg name="update_rate" default="25.0"/>
  <arg name="gui" default="true"/>

  <!-- Start Gazebo with warehouse world -->
  <include file="$(find gazebo_ros)/launch/empty_world.launch">
    <arg name="world_name" value="$(arg world_file)"/>
    <arg name="paused" value="false"/>
    <arg name="use_sim_time" value="true"/>
    <arg name="gui" value="$(arg gui)"/>
    <arg name="headless" value="false"/>
    <arg name="debug" value="false"/>
  </include>

  <!-- Spawn PedSim agents to Gazebo -->
  <node pkg="pedsim_gazebo_plugin" type="spawn_pedsim_agents.py" name="spawn_pedsim_agents" output="screen"/>

  <!-- TF: Place gazebo frame at map frame -->
  <node pkg="tf" type="static_transform_publisher" name="gazebo_map_broadcaster"
      args="0 0 0 0 0 0 odom gazebo 100"/>

  <!-- PedSim Simulator Node (No Robot) -->
  <node name="pedsim_simulator" pkg="pedsim_simulator" type="pedsim_simulator" output="screen">
    <param name="scene_file" value="$(arg scene_file)" type="string"/>
    <param name="simulation_factor" value="$(arg simulation_factor)" type="double"/>
    <param name="update_rate" value="$(arg update_rate)" type="double"/>
    <param name="default_queue_size" value="10" type="int"/>
    <param name="robot_mode" value="0" type="int"/>
    <param name="enable_groups" value="true" type="bool"/>
    <param name="frame_id" value="gazebo"/>
  </node>

  <!-- PedSim Visualizer -->
  <include file="$(find pedsim_visualizer)/launch/visualizer.launch"/>

</launch>
